<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Leticia Pablos Robles">
<meta name="dcterms.date" content="2025-10-10">

<title>Assignment #2 Data Exploration with R - Answer Key ‚Äì Fundamentals of Linear Models 2025-2026: Workbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Workgroup3.html" rel="next">
<link href="./descriptive_stats.html" rel="prev">
<link href="./images/Stats_Ling_Cover_1ed.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Workgroup2.html">Workgroup 2: Data Exploration with R</a></li><li class="breadcrumb-item"><a href="./assignment2_key.html">Assignment #2 Data Exploration with R - Answer Key</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Fundamentals of Linear Models 2025-2026: Workbook</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workbook organization</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Workgroup1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workgroup 1: Introduction to R and RStudio</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_to_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">‚úçÔ∏è R Syntax</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./using_libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üì¶ Libraries and Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./read_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reading and Saving data in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidyverse_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to tidyverse 1: data manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./using_notebooks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reproducible research using Scripts and Notebooks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment1_key.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment #1 - Answer key</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Workgroup2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workgroup 2: Data Exploration with R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data organization and transformation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üìäData visualization in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive_stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descriptive Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment2_key.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Assignment #2 Data Exploration with R - Answer Key</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Workgroup3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workgroup 3: Simple Linear Regression with R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plot_xy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotting relationship between two variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lm_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Models in R with <em>lm()</em></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment3_key.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment #3 Linear fitting with R - Answer Key</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Workgroup4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workgroup 4: Simple Linear Regression II</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Model output</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model selection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Model with Categorical predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_reporting1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Linear Model reporting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment4_key.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment #4 - Linear fitting with R II</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Workgroup5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workgroup 5: Multiple Regression with R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression with Categorical predictor with more than two levels</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Post-hoc testing based on Estimated Marginal Means</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_multiple2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression with several predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment5_key.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment #5 - An EEG Processing Pipeline - Answer Key</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Workgroup6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workgroup 6: Multiple Regression with R II</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression: Interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Treatment Coding vs.&nbsp;Sum Coding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_multicollinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Multicollinearity and Interaction Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#task1-introduction-to-the-dataset" id="toc-task1-introduction-to-the-dataset" class="nav-link active" data-scroll-target="#task1-introduction-to-the-dataset">Task#1: Introduction to the dataset</a>
  <ul class="collapse">
  <li><a href="#load-required-libraries-for-the-assignment" id="toc-load-required-libraries-for-the-assignment" class="nav-link" data-scroll-target="#load-required-libraries-for-the-assignment">1.1 Load required libraries for the assignment</a></li>
  <li><a href="#load-dataset" id="toc-load-dataset" class="nav-link" data-scroll-target="#load-dataset">1.2 Load dataset</a></li>
  </ul></li>
  <li><a href="#task2-explore-data-calculate-summary-statistics" id="toc-task2-explore-data-calculate-summary-statistics" class="nav-link" data-scroll-target="#task2-explore-data-calculate-summary-statistics">Task#2: Explore Data &amp; Calculate Summary Statistics</a>
  <ul class="collapse">
  <li><a href="#select-a-subset-of-the-data" id="toc-select-a-subset-of-the-data" class="nav-link" data-scroll-target="#select-a-subset-of-the-data">2.1 Select a subset of the data</a></li>
  <li><a href="#plot-histograms-of-the-data." id="toc-plot-histograms-of-the-data." class="nav-link" data-scroll-target="#plot-histograms-of-the-data.">2.2 Plot histograms of the data.</a></li>
  <li><a href="#calculate-skewness-and-kurtosis-for-both-rwrt-and-rsrt" id="toc-calculate-skewness-and-kurtosis-for-both-rwrt-and-rsrt" class="nav-link" data-scroll-target="#calculate-skewness-and-kurtosis-for-both-rwrt-and-rsrt">2.3 Calculate Skewness and kurtosis for both RWRT and RSRT</a></li>
  <li><a href="#2b3" id="toc-2b3" class="nav-link" data-scroll-target="#2b3">2.4 Calculate mean and standard deviation</a></li>
  <li><a href="#calculate-five-points-summary" id="toc-calculate-five-points-summary" class="nav-link" data-scroll-target="#calculate-five-points-summary">2.5 Calculate five-points summary</a></li>
  <li><a href="#produce-a-boxplot-for-rwrt" id="toc-produce-a-boxplot-for-rwrt" class="nav-link" data-scroll-target="#produce-a-boxplot-for-rwrt">2.6 Produce a boxplot for RWRT</a></li>
  <li><a href="#normality-checks" id="toc-normality-checks" class="nav-link" data-scroll-target="#normality-checks">2.7 Normality checks</a></li>
  </ul></li>
  <li><a href="#task-3---calculate-data-summaries" id="toc-task-3---calculate-data-summaries" class="nav-link" data-scroll-target="#task-3---calculate-data-summaries">Task #3 - Calculate data summaries</a></li>
  <li><a href="#extra-credit---task4-plotting-with-ggplot2" id="toc-extra-credit---task4-plotting-with-ggplot2" class="nav-link" data-scroll-target="#extra-credit---task4-plotting-with-ggplot2">EXTRA CREDIT - Task#4: Plotting with ggplot2</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Workgroup2.html">Workgroup 2: Data Exploration with R</a></li><li class="breadcrumb-item"><a href="./assignment2_key.html">Assignment #2 Data Exploration with R - Answer Key</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Assignment #2 Data Exploration with R - Answer Key</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<hr>
<section id="task1-introduction-to-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="task1-introduction-to-the-dataset">Task#1: Introduction to the dataset</h2>
<p>Exercises in this assignment used a dataset with real data subset from a real Self-Paced Reading study on Negative Polarity Items and complementizer agreement in Basque (see <a href="https://www.researchgate.net/profile/Francesca-Citron/publication/295663653_NEURAL_CORRELATES_OF_EMOTION_WORD_PROCESSING_THE_INTERACTION_BETWEEN_EMOTIONAL_VALENCE_AND_AROUSAL/links/5a9015a0aca272140561056f/NEURAL-CORRELATES-OF-EMOTION-WORD-PROCESSING-THE-INTERACTION-BETWEEN-EMOTIONAL-VALENCE-AND-AROUSAL.pdf#page=75">Pablos, L., &amp; Saddy, D. (2009)</a>. Negative polarity items and complementizer agreement in Basque. in Alter, K., Horne, M., Lindgren, M., Roll, M., &amp; von Koss Torkildsen, J<em>.(Eds.), Papers from Brain Talk: Discourse with and in the Brain.</em> The 1st Birgit Rausing Language Program Conference in Linguistics. Lund: Lund University, Media Tryck. ISBN: 978-91-633-5561-5.)</p>
<p><strong>This data is a real set with the outputs generated by the software <a href="https://tedlab.mit.edu/~dr/Linger/"><em>Linger</em></a> created by the MIT Ted Lab to easily conduct Self Paced reading experiments</strong></p>
<section id="load-required-libraries-for-the-assignment" class="level3">
<h3 class="anchored" data-anchor-id="load-required-libraries-for-the-assignment">1.1 Load required libraries for the assignment</h3>
<p>The packages required for this assignment are <code>tidyverse</code> and <code>moments</code> for the kurtosis and skewness calculations.</p>
</section>
<section id="load-dataset" class="level3">
<h3 class="anchored" data-anchor-id="load-dataset">1.2 Load dataset</h3>
<p>The data for the exercise is contained in the file <code>BasqueNPI.Rda</code> in the <code>/data</code> folder.</p>
<p>This is a R format file, containing a data table. The data was saved using <code>saveRDS()</code> function so it can be read using <code>readRDS()</code> as described in the <a href="https://lpablosrobles.github.io/Fundamentals-Linear-Models-workbook/read_data.html#sec-r-read">first workgroup section describing how to load a R format file</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Read dataset</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>dfBasqueNPI <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'./data/BasqueNPI.Rda'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The file location can be indicated with <em>absolute</em> or <em>relative</em> paths. The relative paths refers to the current working directory, that is indicated with <code>./</code> , therefore <code>./data/BasqueNPI.Rda</code> can be read as: ‚Äú<em>file <code>BasqueNPI.Rda</code> in the <code>data</code> folder under the current directory</em>‚Äù).</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>A few of you got an error when trying to open the file, saying that the file was corrupted when using the <code>load()</code> function in R.</p>
<p><code>saveRDS()</code> and <code>readRDS()</code> allow to save a single <strong>R</strong> object to a file and to restore the object, . This differs from save<code>()</code> and load(), which save and restore one or more variables into the environment.</p>
</div>
</div>
<p>After this step you have a dataframe in the environment, with the following variables</p>
<ul>
<li><p><strong>EXPT</strong> - Specifies the type of data of the item collected, it contains three different values:</p>
<ul>
<li>practice: items presented at the beginning of the experiment to practice the method</li>
<li>filler: items included in the experiment to ‚Äòdisguise‚Äô the real measured target sentences.</li>
<li>basquenpi: target items corresponding to the experimental manipulation.</li>
</ul></li>
<li><p><strong>Item</strong> ‚Äì Factor identifying the sentence used (coded as a number from 1 to 72).</p></li>
<li><p><strong>Subject</strong> ‚Äì Factor identifying the participant on the experiment (coded as a number from 1 to 32)</p></li>
<li><p><strong>EmbeddedSubject</strong> ‚Äì Factor/predictor indicating the nature of the embedded subject with the following levels:</p>
<ul>
<li>[Empty] ‚Äì for practice and filler items</li>
<li>NP ‚Äì for target sentences with a Noun Phrase as subject</li>
<li>NPI ‚Äì for target sentences with a Negative Polarity Item as subject</li>
</ul></li>
<li><p><strong>AgreementMorphology</strong> ‚Äì Factor/predictor indicating the nature of agreement with the following levels:</p>
<ul>
<li>[Empty] ‚Äì for practice and filler items</li>
<li>Declarative ‚Äì for target sentences that contained a complementizer with declarative morphology</li>
<li>Partitive ‚Äì for target sentences that contained a complementizer with partitive morphology</li>
</ul></li>
<li><p><strong>SequenceBin</strong> ‚Äì the position of the item in the sequence seen by the subject.</p></li>
<li><p><strong>WordNumber</strong> ‚Äì the word number in the sentence (starting with 1)</p></li>
<li><p><strong>Word</strong> ‚Äì Actual word presented</p></li>
<li><p><strong>RegionNumber</strong> ‚Äì Region number for the analysis of the reading time</p></li>
<li><p><strong>RWRT</strong> ‚Äì RaW (recorded) Reading Time of the word</p></li>
<li><p><strong>RWZS</strong> ‚Äì Z-Score of the raw reading time</p></li>
<li><p><strong>RSRT</strong> ‚Äì Calculated Residual Reading Time</p></li>
<li><p><strong>RSZS</strong> ‚Äì Z-Score of the residual reading time</p></li>
<li><p><strong>QPCT</strong> ‚Äì Correctness of the comprehension response (100 ‚Äì correct; 0 ‚Äì incorrect)</p></li>
</ul>
<hr>
</section>
</section>
<section id="task2-explore-data-calculate-summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="task2-explore-data-calculate-summary-statistics">Task#2: Explore Data &amp; Calculate Summary Statistics</h2>
<section id="select-a-subset-of-the-data" class="level3">
<h3 class="anchored" data-anchor-id="select-a-subset-of-the-data">2.1 Select a subset of the data</h3>
<p>Select a subset of data with only the target items from the experiment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Your code</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="ot">&lt;-</span> dfBasqueNPI <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EXPT<span class="sc">==</span><span class="st">"basquenpi"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(basquenpi_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       EXPT Item Subject SequenceBin WordNumber       Word RegionNumber RWRT
1 basquenpi    5       1          11          1      Kepak            1  554
2 basquenpi    5       1          11          2   ziurtatu            2  702
3 basquenpi    5       1          11          3         du            3  412
4 basquenpi    5       1          11          4 ikastolara            4  552
5 basquenpi    5       1          11          5       inor            5  393
6 basquenpi    5       1          11          6  autobusez            6  642
    RWZS    RSRT   RSZS QPCT EmbeddedSubject AgreementMorphology
1 -0.611   14.48 -0.049  100             NPI           Partitive
2 -0.025   -0.71  0.224  100             NPI           Partitive
3 -0.636   35.67 -0.259  100             NPI           Partitive
4 -0.687 -259.50 -0.624  100             NPI           Partitive
5 -0.704  -92.13 -0.321  100             NPI           Partitive
6 -0.301 -115.11 -0.243  100             NPI           Partitive</code></pre>
</div>
</div>
</section>
<section id="plot-histograms-of-the-data." class="level3">
<h3 class="anchored" data-anchor-id="plot-histograms-of-the-data.">2.2 Plot histograms of the data.</h3>
<section id="plot-histogram-of-raw-reading-time-rwrt" class="level4">
<h4 class="anchored" data-anchor-id="plot-histogram-of-raw-reading-time-rwrt">Plot histogram of Raw Reading Time (RWRT)</h4>
<p>To plot a histogram of the <strong>Raw Reading Time (RWRT)</strong> we use <code>ggplot()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot histogram</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> RWRT)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What can we observe in this distribution?</p>
<ul>
<li><p>It is a disribution skewed to the right with a lower limit of 0 -&gt; Since RWRT measures the Raw Reading Time, the minimum reading time is zero, obviously, as it can not contain negatives values.</p></li>
<li><p>The graph extends above 10000. Although not visible, that implies that there are</p></li>
<li><p>Most values seem to be between 0 and 2000: the default plot created by <code>geom.histogram()</code> uses 30 subdivisions or <em>bins</em>. To have a more fine grouping, we can indicate the number of bins used with the argument <code>bins</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> RWRT)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ul>
<!-- -->
<ul>
<li><p>Now it can be clearly seen that the bigger proportion of reading times is between 500 and 1000 ms.</p></li>
<li><p>The distribution is very right skewed because there are probably a few measurements with very long reading time (e.g.&nbsp;possibly a participant loosing attention and not pressing a key).</p></li>
</ul>
<p>We can check the histogram only for values of the RWRT less than a certain limit.</p>
<p>We will normally perform a filtering of outliers based on the knowledge of our experiement and the intial data exploration. For example, looking at the plot above, we could eliminate those trials with RWRT &gt; 3000 ms considering that they are too long to be valid. Let‚Äôs plot a new histogram with only those trials with RWRT &lt; 3000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RWRT<span class="sc">&lt;</span><span class="dv">3000</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> RWRT)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Now we can see that the distribution is more symmetric, after removing outlayer points with RWRT &gt; 3000. If we want to see how many trials we have removed with the filtering, we can calculate the percentage of trial removed</li>
</ul>
<p><span class="math inline">\(Percentage\,removed\,trials = \dfrac{n_{total}-n_{filtered}}{n_{total}}*100\)</span>.</p>
<p>There are many ways to know the size of observations in a dataframe (i.e.&nbsp;number of rows). The example below uses the function <code>nrow()</code> . We also demonstrate how you can write the results with a message on the screen using <code>cat()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculation</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>n_filtered <span class="ot">&lt;-</span> basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RWRT<span class="sc">&lt;</span><span class="dv">3000</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>n_removed <span class="ot">&lt;-</span> (n_total <span class="sc">-</span> n_filtered)<span class="sc">/</span>n_total <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total number of observations: "</span>, n_total, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total number of observations:  7328 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of observations with RWRT &gt; 3000: "</span>, (n_total <span class="sc">-</span> n_filtered) , <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of observations with RWRT &gt; 3000:  44 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Percentage of data removed: "</span>, n_removed, <span class="st">"%"</span>,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of data removed:  0.6004367 % </code></pre>
</div>
</div>
<p>Removing data points with RWRT &gt; 3000, only results in 0.6% of the data being discarded.</p>
</section>
<section id="plot-a-histogram-of-the-residual-reading-time-rsrt" class="level4">
<h4 class="anchored" data-anchor-id="plot-a-histogram-of-the-residual-reading-time-rsrt">Plot a histogram of the <u><strong>Residual Reading Time (RSRT)</strong></u></h4>
<p>The Residual Reading Time (RSRT) is a way to correct for sentence length, word length, and individual differences between participants‚Äô reading speeds. It is referenced to the average reading time per participant, and can have negative values (indicating faster reading than the average). We will look at the way it is calculated in an assignment once we have gone over the principles of regression.</p>
<p>For the purpose of this exercise we can plot the histogram to compare with the RWRT.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> RSRT)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Provide your observations on the distribution:</p>
<ul>
<li><p>The distribution is roughly centered around 0, and it is more symmetric than the RWRT.</p></li>
<li><p>Let‚Äôs plot the distribution of RSRT filtering the data as above based on the <strong>RWRT</strong> (RWRT&lt;3000).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RWRT<span class="sc">&lt;</span><span class="dv">3000</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> RSRT)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>,We can see that the distribution is centered around 0 and still skewed to the right.</p></li>
</ul>
</section>
</section>
<section id="calculate-skewness-and-kurtosis-for-both-rwrt-and-rsrt" class="level3">
<h3 class="anchored" data-anchor-id="calculate-skewness-and-kurtosis-for-both-rwrt-and-rsrt">2.3 Calculate Skewness and kurtosis for both RWRT and RSRT</h3>
<p>Skewness and kurtosis values using the functions with the same name in the library <code>moments</code>.</p>
<p>Calculate Skewness for RWRT</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(basquenpi_data<span class="sc">$</span>RWRT)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.682073</code></pre>
</div>
</div>
<p>What does the output value indicate?</p>
<ul>
<li>A positive skewness value means that the distribution is right skewed. This is quite clear looking at the histogram above.</li>
</ul>
<p>Calculate Kurtosis for <code>RWRT</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(basquenpi_data<span class="sc">$</span>RWRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96.25985</code></pre>
</div>
</div>
<p>What does the output value indicate?</p>
<ul>
<li>A positive kurtosis indicates a distribution more <em>peaked</em> than a normal distribution with the same mean and standard deviation.</li>
</ul>
<p>Below we calculate the same values for the <code>RSRT</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(basquenpi_data<span class="sc">$</span>RSRT) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.348828</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(basquenpi_data<span class="sc">$</span>RSRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 118.0003</code></pre>
</div>
</div>
<ul>
<li>As can be seen the <code>RSRT</code> is even more skewed and with higher kurtosis (more ‚Äòpointy‚Äô) than the <code>RWRT</code> distribution.</li>
</ul>
<p>Finally let‚Äôs look at the values on the dataset for values of RT &lt; 3000 ms</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>basquenpi_filtered<span class="ot">&lt;-</span>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RWRT <span class="sc">&lt;</span> <span class="dv">3000</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(basquenpi_filtered<span class="sc">$</span>RWRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.377025</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(basquenpi_filtered<span class="sc">$</span>RWRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.67131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(basquenpi_filtered<span class="sc">$</span>RSRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.226802</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(basquenpi_filtered<span class="sc">$</span>RSRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.14173</code></pre>
</div>
</div>
<p>The value show that the distribution is closer to a normal (not normal though) in both measures after the filtering as expected.</p>
</section>
<section id="2b3" class="level3">
<h3 class="anchored" data-anchor-id="2b3">2.4 Calculate mean and standard deviation</h3>
<p>Calculate the mean and standard deviation of the Raw Reading Time (RWRT) for the different experimental conditions <u><strong>in Region Number 5</strong></u> to generate a summary table.</p>
<p>There are many ways to do this in R. Below we include one way using tidyverse summarize function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RegionNumber<span class="sc">==</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(EmbeddedSubject,AgreementMorphology) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">m_rwrt =</span> <span class="fu">mean</span>(RWRT))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'EmbeddedSubject'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 3
# Groups:   EmbeddedSubject [2]
  EmbeddedSubject AgreementMorphology m_rwrt
  &lt;fct&gt;           &lt;fct&gt;                &lt;dbl&gt;
1 NP              Declarative           751.
2 NP              Partitive             751.
3 NPI             Declarative           662.
4 NPI             Partitive             587.</code></pre>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 35%">
<col style="width: 22%">
<col style="width: 29%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><strong><em>Mean</em></strong></th>
<th style="text-align: right;"></th>
<th style="text-align: center;"><strong>Embedded Subject</strong></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"><strong>NP</strong></td>
<td style="text-align: center;"><strong>NPI</strong></td>
</tr>
<tr class="even">
<td style="text-align: right;"><strong>Agreement Morphology</strong></td>
<td style="text-align: right;"><strong>Declarative</strong></td>
<td style="text-align: center;">750.70</td>
<td style="text-align: center;">661.67</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"><strong>Partitive</strong></td>
<td style="text-align: center;">751.33</td>
<td style="text-align: center;">586.60</td>
</tr>
</tbody>
</table>
<p>A similar approach can be followed to calculate the Standard deviations table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RegionNumber<span class="sc">==</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(EmbeddedSubject,AgreementMorphology) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">sd_rwrt =</span> <span class="fu">sd</span>(RWRT))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'EmbeddedSubject'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 3
# Groups:   EmbeddedSubject [2]
  EmbeddedSubject AgreementMorphology sd_rwrt
  &lt;fct&gt;           &lt;fct&gt;                 &lt;dbl&gt;
1 NP              Declarative            357.
2 NP              Partitive              441.
3 NPI             Declarative            808.
4 NPI             Partitive              275.</code></pre>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 34%">
<col style="width: 23%">
<col style="width: 29%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><strong><em>Std Dev</em></strong></th>
<th style="text-align: right;"></th>
<th style="text-align: center;"><strong>EmbeddedSubject</strong></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"><strong>NP</strong></td>
<td style="text-align: center;"><strong>NPI</strong></td>
</tr>
<tr class="even">
<td style="text-align: right;"><strong>AgreementMorphology</strong></td>
<td style="text-align: right;"><strong>Declarative</strong></td>
<td style="text-align: center;">357.30</td>
<td style="text-align: center;">807.98</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"><strong>Partitive</strong></td>
<td style="text-align: center;">440.71</td>
<td style="text-align: center;">274.91</td>
</tr>
</tbody>
</table>
</section>
<section id="calculate-five-points-summary" class="level3">
<h3 class="anchored" data-anchor-id="calculate-five-points-summary">2.5 Calculate five-points summary</h3>
<p>Calculate and create a table with the five-point summary (i.e., min, max, median, 1st quartile(Q1) and 3rd quartile(Q3)) for the <u><strong>Residual Reading Time (RSRT)</strong></u> for the following subset of data:</p>
<ul>
<li>EmbeddedSubject = NP</li>
<li>AgreementMorphology = Partitive</li>
<li>Region Number = 5</li>
</ul>
<p>We can use the <code>summary()</code> function to calculate the 5-point summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data_subset <span class="ot">&lt;-</span> basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>( (RegionNumber <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">&amp;</span> (AgreementMorphology<span class="sc">==</span><span class="st">"Partitive"</span>) <span class="sc">&amp;</span>(EmbeddedSubject <span class="sc">==</span> <span class="st">"NP"</span>)) </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(basquenpi_data_subset<span class="sc">$</span>RSRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-495.320  -90.130    0.985   83.313  120.080 3089.090 </code></pre>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Min</th>
<th>Max</th>
<th>median</th>
<th>1st Quartile</th>
<th>3rd Quartile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>-495.32</td>
<td>3089.09</td>
<td>0.985</td>
<td>-90.13</td>
<td>120.08</td>
</tr>
</tbody>
</table>
</section>
<section id="produce-a-boxplot-for-rwrt" class="level3">
<h3 class="anchored" data-anchor-id="produce-a-boxplot-for-rwrt">2.6 Produce a boxplot for RWRT</h3>
<section id="create-a-boxplot-for-rsrt" class="level4">
<h4 class="anchored" data-anchor-id="create-a-boxplot-for-rsrt">2.6.1. Create a boxplot for RSRT</h4>
<p>Produce a <u><strong>boxplot for the RWRT</strong></u> in different conditions reflected in the table of task 2.4: in Region 5, for the conditions Declarative NP, Declarative NPI, Partitive NP, Partitive NPI.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RegionNumber <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>EmbeddedSubject, <span class="at">y=</span> RWRT, <span class="at">fill =</span> AgreementMorphology)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What can you observe in the plot?:</p>
<ul>
<li>There is a clear outlier in the <em>NPI-Declarative</em> condition.</li>
<li>The <em>NP-Partitive</em> condition seems to have more dispersion that the other ones.</li>
</ul>
<p>If we plot again the same filtering the data to keep only the points with <code>RWRT &lt; 2500</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>( (RegionNumber <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">&amp;</span> (RWRT <span class="sc">&lt;</span> <span class="dv">2500</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>EmbeddedSubject, <span class="at">y=</span> RWRT, <span class="at">fill =</span> AgreementMorphology)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What differences do you observe with the previous plot?</p>
<ul>
<li><p>Now it is clearer to appretiate what is the difference between the different conditions.</p></li>
<li><p>This plot allows a clear comparison between the different levels of <code>AgreementMorphology</code>, but what is we wanted to compare NPI vs NP within each level of <code>AgreementMorphology</code><em>?</em> We can exchange the variables between <code>x</code> and the <code>fill</code> arguments.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>( (RegionNumber <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">&amp;</span> (RWRT <span class="sc">&lt;</span> <span class="dv">2500</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>AgreementMorphology, <span class="at">y=</span> RWRT, <span class="at">fill =</span> EmbeddedSubject)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="create-a-boxplot-for-rsrt-1" class="level4">
<h4 class="anchored" data-anchor-id="create-a-boxplot-for-rsrt-1">2.6.3. Create a boxplot for <code>RSRT</code></h4>
<p>As in the previous section, we create now the boxplot for <code>RSRT</code> as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RegionNumber <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>EmbeddedSubject, <span class="at">y=</span> RSRT, <span class="at">fill =</span> AgreementMorphology)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again if we filter the data with a RWRT &lt; 2500</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>( (RegionNumber <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">&amp;</span> (RWRT <span class="sc">&lt;</span> <span class="dv">2500</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>EmbeddedSubject, <span class="at">y=</span> RSRT, <span class="at">fill =</span> AgreementMorphology)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comment-on-the-differences-between-the-rwrt-and-rsrt-plot." class="level4">
<h4 class="anchored" data-anchor-id="comment-on-the-differences-between-the-rwrt-and-rsrt-plot.">2.6.4. Comment on the differences between the RWRT and RSRT plot.</h4>
<ul>
<li>In the RWRT plots it can be seen that NPI conditions hae lower dispersion than NP conditions (boxes are smaller)</li>
<li>the RSRT is centered around 0 ms, as expected, however there are still a very significant number of outliers, with residuals over 1000 ms. This requires assessment during data analysis. We will look at this in future assignments.</li>
</ul>
</section>
</section>
<section id="normality-checks" class="level3">
<h3 class="anchored" data-anchor-id="normality-checks">2.7 Normality checks</h3>
<p>To check the distribution of the data, we saw in the lecture that a Quantile-Quantile Plot (qqplot) can be used. The function <code>qqplot()</code> is generic and compares some data with any type of distribution. To compare your data with a normal distribution and check normality, you can use <code>qnorm()</code>.</p>
<p>We generate the Quartile-Quartile plot for RWRT using the command below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(basquenpi_data<span class="sc">$</span>RWRT)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(basquenpi_data<span class="sc">$</span>RWRT, <span class="at">col =</span> <span class="st">'red'</span>,<span class="at">lty=</span><span class="st">'dashed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot deviates clearly from a straight line, as expected by the skewness and kurtosis values calculated in <a href="#2.2">task 2.2</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the code we have used <code>qqline()</code> to plot a reference straight line for visual comparison of the separation from the expected line in a normal distribution.</p>
</div>
</div>
<p>For comparison, let‚Äôs look at the q-q plot for the filtered data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data_filtered <span class="ot">&lt;-</span> basquenpi_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RWRT<span class="sc">&lt;</span><span class="dv">2500</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(basquenpi_data_filtered<span class="sc">$</span>RWRT)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(basquenpi_data<span class="sc">$</span>RWRT, <span class="at">col =</span> <span class="st">'red'</span>,<span class="at">lty=</span><span class="st">'dashed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Although the plot is more linear, still deviates from the normal distribution.</p>
<hr>
</section>
</section>
<section id="task-3---calculate-data-summaries" class="level2">
<h2 class="anchored" data-anchor-id="task-3---calculate-data-summaries">Task #3 - Calculate data summaries</h2>
<p>The assignment asked to generate a summary dataframe (<em><code>basquenpi_data_summary</code></em> ) using the <code>filter()</code>, <code>group_by()</code> and <code>summarize()</code>functions in <code>dplyr</code> with the data grouped by the factors <code>RegionNumber</code>, <code>EmbeddedSubject</code> and <code>AgreementMorphology</code>, and summarized via the addition of columns specifying the mean and standard deviations of the <u><strong>Raw Reading Time</strong></u> and <u><strong>Residual Reading Time</strong>.</u></p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Several of you pointed out that the <code>filter()</code> function was not required to be used in this task, which is correct starting from the data already filtered in task 2.1.</p>
<p>In the code below I assumed to perform a full processing chain from raw data to illustrate how using pipes can render readable code with all operations of the data together.</p>
<p>Of course both approaches are correct.</p>
</div>
</div>
<p>We can generate the requested output with the following code line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data_summary <span class="ot">&lt;-</span> dfBasqueNPI <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EXPT <span class="sc">==</span> <span class="st">"basquenpi"</span>) <span class="sc">%&gt;%</span>   <span class="co">#filter the data</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(EmbeddedSubject,AgreementMorphology, RegionNumber) <span class="sc">%&gt;%</span> <span class="co">#apply a grouping</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarize</span>(<span class="at">mean_rt =</span> <span class="fu">mean</span>(RWRT), <span class="at">sd_rt=</span><span class="fu">sd</span>(RWRT), <span class="at">mean_rs =</span> <span class="fu">mean</span>(RSRT), <span class="at">sd_rs=</span> <span class="fu">sd</span>(RSRT))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'EmbeddedSubject', 'AgreementMorphology'.
You can override using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(basquenpi_data_summary,<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 √ó 7
# Groups:   EmbeddedSubject, AgreementMorphology [2]
   EmbeddedSubject AgreementMorphology RegionNumber mean_rt sd_rt mean_rs sd_rs
   &lt;fct&gt;           &lt;fct&gt;                      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 NP              Declarative                    1    789.  436.   41.4   388.
 2 NP              Declarative                    2    727.  395.  -36.3   360.
 3 NP              Declarative                    3    611.  414.  104.    369.
 4 NP              Declarative                    4    893.  492.   16.1   406.
 5 NP              Declarative                    5    751.  357.   84.3   330.
 6 NP              Declarative                    6    759.  352.  -28.2   312.
 7 NP              Declarative                    7    627.  292.  -68.2   268.
 8 NP              Declarative                    8    515.  186.  -82.3   177.
 9 NP              Declarative                    9    681.  406.  -71.6   352.
10 NP              Declarative                   10    700.  554.  -79.8   557.
11 NP              Partitive                      1    745.  371.   -3.58  338.
12 NP              Partitive                      2    713.  273.  -49.1   277.
13 NP              Partitive                      3    573.  288.   65.7   260.
14 NP              Partitive                      4    971.  716.  102.    664.
15 NP              Partitive                      5    751.  441.   83.3   413.
16 NP              Partitive                      6    786.  405.   -1.84  362.
17 NP              Partitive                      7    621.  299.  -74.4   288.
18 NP              Partitive                      8    613.  321.  -29.2   297.
19 NP              Partitive                      9    852.  950.  112.    911.
20 NP              Partitive                     10    865.  560.   56.2   562.</code></pre>
</div>
</div>
<hr>
</section>
<section id="extra-credit---task4-plotting-with-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="extra-credit---task4-plotting-with-ggplot2">EXTRA CREDIT - Task#4: Plotting with ggplot2</h2>
<p>The plot we want to create shows the mean <code>RWRT</code> for each region for the conditions where <code>EmbeddedSubject==NP</code>, for the two different levels of <code>AgreementMorphology</code>.</p>
<p>We present below the step-by-step code to build up the plot, and at the end we put it all together in a single code line.</p>
<p>From the dataframe created in <a href="#3b2">task 3.2</a> first we select the subset of cases where <em><code>EmbeddedSubject==NP</code></em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>basque_npi_summary_NP <span class="ot">&lt;-</span> basquenpi_data_summary <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EmbeddedSubject<span class="sc">==</span><span class="st">"NP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First step is to create a <em>definition</em> for a plot. With the command below, we create a plot based on the data in <code>basque_npi_summary_NP</code> and <em>save</em> the plot definition in a variable called p.&nbsp;Typing the name of the variable shows the information from the plot as we build it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(basque_npi_summary_NP) </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>At this point, nothing is shown, because we only specified that we will make a plot based on the data. The next step is to add the <em>Aesthetics</em>. This specifies what data the plot will use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>p<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>RegionNumber, <span class="at">y=</span>mean_rt) </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With the command above, we informed that we will plot the <em><code>mean_rt</code></em> as a function of the <em><code>RegionNumber</code></em>. Still nothing is displayed, because we haven‚Äôt said yet how we plot it (lines, points, bars, etc). As you can see, we don‚Äôt need to provide in the commad the name of the variable containing the columns <em><code>mean_rt</code></em> and <em><code>RegionNumber</code></em>, because <code>p</code> <em>knows</em> which is the underlying data of the graph.</p>
<p>With the next command, we specify that we want to have a line using <code>geom_line()</code>, where each type of line corresponds one of the levels of <code>AgreementMorphology</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>AgreementMorphology))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now, as you can see we get a graph!</p>
<p>On purpose, I did not saved the result back in the <em><code>p</code></em> variable, to illustrate a point. What if we wanted to have instead a barchart? We just call <em><code>geom_bar()</code></em> instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>,<span class="fu">aes</span>(<span class="at">fill=</span>AgreementMorphology),<span class="at">position=</span><span class="fu">position_dodge</span>() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Coming back to our example, let‚Äôs add data points to the chart using <code>geom_point()</code>, where each point shape is also dependent on the level of <code>Agreement Morphology</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>AgreementMorphology))<span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span>AgreementMorphology)) </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We have now all the information we wanted in the chart and stored in the variable <em><code>p</code></em>. For the axis, the <code>RegionNumber</code> only makes sense as a discrete value. The command below adds information on the x scale, defining it a continuous with values in a sequence from 1 to 10 in steps of 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>)) </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The last step is to complete the <em>decorations</em> of the graph. We can do that using a number of functions from the <code>ggplot2</code> library.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_grey</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is the plot requested to reproduce.</p>
<p>If we put the code together, we could do the following</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> basquenpi_data_summary <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EmbeddedSubject<span class="sc">==</span><span class="st">"NP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> RegionNumber, <span class="at">y =</span> mean_rt)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>AgreementMorphology)) <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span>AgreementMorphology)) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">scale_color_grey</span>() <span class="sc">+</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">theme_classic</span>() </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Same plot as before.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that in this exercise we maintain black and white (and grey) color with dashed and solid lines that is a format normally used for many publications.</p>
</div>
</div>
<hr>
<p>As an illustration, let‚Äôs expand the example to include also error bars in the plot with the Standard Error of each point.</p>
<p>As a reminder, the standard error can be calculated as</p>
<p><span class="math inline">\(SE = \frac{\sigma_{\bar{X}}}{\sqrt{n}}\)</span></p>
<p>First, let‚Äôs modify the summary variable to also calculate the SE in the variables <code>se_rt</code> and <code>se_rs</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>basquenpi_data_summary_new <span class="ot">&lt;-</span> dfBasqueNPI <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EXPT <span class="sc">==</span> <span class="st">"basquenpi"</span>) <span class="sc">%&gt;%</span>   <span class="co">#filter the data</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">group_by</span>(EmbeddedSubject,AgreementMorphology, RegionNumber) <span class="sc">%&gt;%</span>       </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">summarize</span>( <span class="at">mean_rt =</span> <span class="fu">mean</span>(RWRT), </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sd_rt=</span><span class="fu">sd</span>(RWRT), </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">se_rt =</span> sd_rt<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()), </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">mean_rs =</span> <span class="fu">mean</span>(RSRT), </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sd_rs=</span> <span class="fu">sd</span>(RSRT), </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">se_rs =</span> sd_rs<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'EmbeddedSubject', 'AgreementMorphology'.
You can override using the `.groups` argument.</code></pre>
</div>
</div>
<p>In our plot, we want to display for every category an error bar. This can be done with the <code>ggplot</code> function <code>geom_errorbar()</code>. That function has two main arguments to specify the range of the error bar: <code>ymin</code> and <code>ymax</code> . The values of the error bars are <span class="math inline">\(\overline{X}\pm SE\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> basquenpi_data_summary_new <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EmbeddedSubject<span class="sc">==</span><span class="st">"NP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> RegionNumber, <span class="at">y =</span> mean_rt)) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>AgreementMorphology)) <span class="sc">+</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span>AgreementMorphology)) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_color_grey</span>() <span class="sc">+</span> </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_rt<span class="sc">-</span>se_rt, <span class="at">ymax =</span> mean_rt<span class="sc">+</span>se_rt) , <span class="at">width=</span> <span class="fl">0.2</span>,<span class="at">color =</span> <span class="st">'grey'</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment2_key_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is a more adequate plot to assess the data, as it shows that in some regions, the difference is within the error (e.g.&nbsp;Region 6) and might not be significant. We will look in future workgroups at how to confirm this statistically with a linear model.</p>
<hr>
<p>End of the assignment #2</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./descriptive_stats.html" class="pagination-link" aria-label="Descriptive Statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Descriptive Statistics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Workgroup3.html" class="pagination-link" aria-label="Workgroup 3: Simple Linear Regression with R">
        <span class="nav-page-text">Workgroup 3: Simple Linear Regression with R</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Fundamentals of Linear Models Workbook was written by Dr.&nbsp;Leticia Pablos Robles</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This workbook was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>